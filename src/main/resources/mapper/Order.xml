<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.wechatfilm.mapper.OrderMapper">
<!--  查询列表  -->
<resultMap id="orderList" type="com.wechatfilm.entity.Order">
    <!--  column 对应的值为sql语句中对应字段  -->
    <id column="oid" property="id" javaType="Integer"></id>
    <result column="code" property="code" javaType="String"></result>
    <result column="o_price" property="price" javaType="BigDecimal"></result>
    <result column="brand" property="brand" javaType="String"></result>
    <result column="o_createtime" property="createtime" javaType="Date"></result>
    <result column="o_begintime" property="begintime" javaType="Date"></result>
    <result column="o_endtime" property="endtime" javaType="Date"></result>
    <result column="captcha" property="captcha" javaType="String"></result>
    <result column="status" property="status" javaType="Integer"></result>
    <!--  使用ofType, 因为使用了List, 如果用javaType会报错数据类型不匹配  -->
    <collection property="users" ofType="com.wechatfilm.entity.User">
        <id column="userId" property="userId" javaType="Integer"></id>
        <result column="u_name" property="name" javaType="String"></result>
        <result column="username" property="username" javaType="String"></result>
        <result column="password" property="password" javaType="String"></result>
        <result column="age" property="age" javaType="Integer"></result>
        <result column="u_createtime" property="createtime" javaType="Date"></result>
        <result column="sex" property="sex" javaType="String"></result>
        <result column="u_phone" property="phone" javaType="String"></result>
        <result column="headpic" property="headpic" javaType="String"></result>
    </collection>
</resultMap>

    <select id="getOrderList" resultMap="orderList" parameterType="Integer">
        select o.id oid ,o.code, o.price o_price, o.brand, o.createtime o_createtime, o.begintime o_begintime,
               o.endtime o_endtime, o.captcha, o.status, u.userId, u.name u_name, u.username,
               u.password, u.age, u.createtime u_createtime, u.sex, u.phone u_phone, u.headpic
        from order o, usertable u
        where o.userid = u.userId
--         and o.userid = #{userid}


--         select
--                a.id uid,a.username,a.avatar,a.email,a.password,
--                a.status ustatus,a.created ucreated,a.last_login,
--                b.id bid,b.user_id,b.title,b.description,b.content,
--                b.created bcreated,b.status bstatus
--         from m_user a , m_blog b
--         where a.id=b.user_id and a.id=#{id}
    </select>

<!--  下单  -->
    <insert id="placeOrder">
        insert into order (id, code, userid, filmid, roomid, price, brand, begintime, endtime, captcha, status)
        values (#{id}, #{code}, #{userid}, #{filmid}, #{roomid}, #{price}, #{brand}, #{begintime}, #{endtime}, #{captcha}, #{status});
    </insert>



</mapper>




























